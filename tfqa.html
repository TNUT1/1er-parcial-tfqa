<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TFQA ‚Äì Mega‚ÄëQuiz de Repaso (Parcial 1)</title>
<style>
  :root{--bg:#0b0e14;--card:#151a24;--ink:#e9eef5;--mut:#9aa4b2;--ok:#1fbe74;--bad:#ff4d4f;--bd:#2a3246;--accent:#6ea8fe}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.45 system-ui,Segoe UI,Roboto,Arial}
  header{position:sticky;top:0;z-index:9;background:#0b0e14cc;border-bottom:1px solid var(--bd);backdrop-filter:blur(6px)}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}
  h1{margin:0 0 6px;font-size:1.15rem}
  .mut{color:var(--mut)}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .pill{border:1px solid var(--bd);border-radius:999px;padding:6px 10px;color:var(--mut)}
  button,select,input{border:1px solid var(--bd);border-radius:10px;background:#0f1524;color:var(--ink);padding:8px 12px;font-weight:600;cursor:pointer}
  button:hover,select:hover{border-color:var(--accent)}
  .tabs{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
  .tab{border:1px solid var(--bd);background:#121a2f;color:var(--ink);padding:8px 12px;border-radius:999px;cursor:pointer}
  .tab.active{background:#1b2441;border-color:#3f5aa5}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(340px,1fr));gap:14px;margin:16px auto}
  .card{background:var(--card);border:1px solid var(--bd);border-radius:14px;padding:14px}
  .qhead{display:flex;gap:8px;align-items:flex-start;margin-bottom:10px}
  .qno{font-variant-numeric:tabular-nums;background:#0f1524;border:1px solid var(--bd);color:#9cc0ff;padding:2px 8px;border-radius:8px}
  .tag{margin-left:auto;color:#aeb7ff;font-size:.75rem;border:1px solid var(--bd);border-radius:8px;padding:2px 8px}
  .options{display:flex;flex-direction:column;gap:8px}
  .opt{border:1px solid var(--bd);background:#0f1524;border-radius:10px;padding:9px 10px;display:flex;gap:10px;align-items:center;cursor:pointer}
  .opt .letter{width:22px;height:22px;display:grid;place-items:center;border-radius:6px;border:1px solid var(--bd);background:#151a2c;color:#9aa4b2;font-weight:700}
  .opt.right{border-color:var(--ok);background:rgba(31,190,116,.08)} .opt.right .letter{background:var(--ok);border-color:var(--ok);color:#00180c}
  .opt.wrong{border-color:var(--bad);background:rgba(255,77,79,.08)} .opt.wrong .letter{background:var(--bad);border-color:var(--bad);color:#1d0000}
  .explain{margin-top:8px;color:var(--mut);font-size:.9rem}
  .footer{display:flex;justify-content:space-between;align-items:center;color:var(--mut);margin:8px 0 18px}
  .legend{display:flex;gap:10px;align-items:center}
  .dot{width:10px;height:10px;border-radius:50%}
  .ok{background:var(--ok)} .bad{background:var(--bad)}
  .fab{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:8px;z-index:10}
  .accent{background:#1b2441}
  @media (max-width:600px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>TFQA ‚Äì Mega‚ÄëQuiz de Repaso (Parcial 1)</h1>
    <div class="mut">Bloques: <b>TM&E</b> (transferencias y m√©todos), <b>LIP</b> (l√≠pidos/fritura), <b>HUE</b>, <b>CAR</b>, <b>HC‚ÄëBPM</b>, <b>CEL‚ÄëLEG</b>, <b>LEC</b> (leche), <b>GLU</b> (gluten), <b>F&H</b> (frutas/hortalizas), <b>ALM</b> (almid√≥n/APM), <b>BPM</b> (buenas pr√°cticas), <b>NORM</b> (receta/ficha).</div>
    <div class="row" style="margin-top:8px">
      <span class="pill">Preguntas: <b id="count">0</b></span>
      <span class="pill">Contestadas: <b id="answered">0</b></span>
      <span class="pill">Correctas: <b id="right">0</b></span>
      <button id="shuffle" class="accent">Barajar opciones</button>
      <button id="reset">Reiniciar</button>
      <span class="pill">Buscar: <input id="search" placeholder="ej. Maillard, clorofila, UHT, CRA"/></span>
    </div>
    <div class="tabs">
      <button class="tab active" data-tab="ALL">Todas</button>
      <button class="tab" data-tab="TM&E">TM&E</button>
      <button class="tab" data-tab="LIP">LIP</button>
      <button class="tab" data-tab="HUE">HUE</button>
      <button class="tab" data-tab="CAR">CAR</button>
      <button class="tab" data-tab="HC‚ÄëBPM">HC‚ÄëBPM</button>
      <button class="tab" data-tab="CEL‚ÄëLEG">CEL‚ÄëLEG</button>
      <button class="tab" data-tab="LEC">LEC</button>
      <button class="tab" data-tab="GLU">GLU</button>
      <button class="tab" data-tab="F&H">F&H</button>
      <button class="tab" data-tab="ALM">ALM</button>
      <button class="tab" data-tab="BPM">BPM</button>
      <button class="tab" data-tab="NORM">NORM</button>
    </div>
  </div>
</header>
<main class="wrap">
  <div id="grid" class="grid"></div>
  <div class="footer">
    <div class="legend"><span class="dot ok"></span> Correcta <span class="dot bad" style="margin-left:12px"></span> Incorrecta</div>
    <div>Progreso: <b id="progress">0</b>%</div>
  </div>
</main>
<div class="fab">
  <button id="toTop">‚¨ÜÔ∏è Arriba</button>
  <button id="toBot">‚¨áÔ∏è Abajo</button>
</div>
<script>
// ===== Banco de preguntas =====
// {tag:'', q:'', options:['','','',''], correct:idx, explain:''}
const BANK = [
  // TM&E ‚Äì Transferencias y m√©todos (11)
  {tag:'TM&E', q:'La cocci√≥n se define como‚Ä¶', options:[
    'Operaci√≥n t√©rmica que modifica aspecto, textura, valor nutritivo y calidad microbiol√≥gica',
    'Solo dorar la superficie del alimento',
    '√önicamente un proceso f√≠sico sin cambios qu√≠micos',
    'Proceso que no afecta a los sentidos'], correct:0, explain:'Definici√≥n integral: impacto f√≠sico, qu√≠mico, sensorial y microbiol√≥gico.'},
  {tag:'TM&E', q:'Conducci√≥n es dominante en‚Ä¶', options:['Plancha/metales; lenta en s√≥lidos','Horno convecci√≥n forzada','Microondas','Vapor'], correct:0, explain:'Transferencia molecula a mol√©cula, eficiente en metales.'},
  {tag:'TM&E', q:'Convecci√≥n natural/forzada ocurre en‚Ä¶', options:['L√≠quidos y gases (agua/aire/aceite/vapor)','S√≥lidos cristalinos','Vac√≠o sin fluido','Solo en hornos est√°ticos'], correct:0, explain:'Movimiento de masas de fluido; depende de propiedades t√©rmicas y capa l√≠mite.'},
  {tag:'TM&E', q:'Radiaci√≥n no requiere contacto y en cocina destaca‚Ä¶', options:['Infrarroja; hornos/parrillas','Conducci√≥n a trav√©s de sart√©n','Convecci√≥n de aceite','Inducci√≥n magn√©tica'], correct:0, explain:'Transferencia por ondas; parrilla/sol/quemadores.'},
  {tag:'TM&E', q:'Inducci√≥n calienta porque‚Ä¶', options:['Campo magn√©tico induce corrientes y agitaci√≥n magn√©tica en material ferromagn√©tico','El aire caliente rodea el recipiente','Los rayos UV ionizan el agua','La resistencia el√©ctrica del cobre irradia'], correct:0, explain:'P√©rdidas magn√©ticas ‚Üí calor en la olla adecuada.'},
  {tag:'TM&E', q:'Secuencia de transferencia de energ√≠a en cocci√≥n:', options:['Medio‚Üísuperficie‚Üíinterior‚Üítras retiro (enfriamiento)','Interior‚Üísuperficie‚Üímedio','Superficie‚Üímedio‚Üíinterior','No existe secuencia'], correct:0, explain:'Flujo desde el medio hasta el centro; luego evoluci√≥n al retirarlo.'},
  {tag:'TM&E', q:'Rol del agua en el alimento:', options:['Protege superficie y transmite calor internamente','Solo aporta sabor','Impide toda reacci√≥n qu√≠mica','Disminuye conductividad t√©rmica'], correct:0},
  {tag:'TM&E', q:'V√≠a seca se caracteriza por‚Ä¶', options:['Medio sin agua (horno, plancha, fritura, salteado, vac√≠o, spiedo)','Uso de agua como medio','Solo microondas','No produce pardeamientos'], correct:0, explain:'Favorece pardeamientos no enzim√°ticos: caramelizaci√≥n/dextrinizaci√≥n.'},
  {tag:'TM&E', q:'V√≠a h√∫meda incluye‚Ä¶', options:['Hervir, vapor, escaldado, presi√≥n','Parrilla y plancha','Fritura por aire','Sous‚Äëvide siempre > 100¬∞C'], correct:0},
  {tag:'TM&E', q:'Microondas calienta principalmente por‚Ä¶', options:['Rotaci√≥n de dipolos de agua por microondas de alta frecuencia','Conducci√≥n desde la base','Irradiaci√≥n UV ionizante','Reacciones exot√©rmicas de Maillard'], correct:0},
  {tag:'TM&E', q:'Traslado a m√©todo: parrilla, horno, plancha:', options:[
    'Parrilla‚Üíradiaci√≥n IR; Horno‚Üíconvecci√≥n; Plancha‚Üíconducci√≥n',
    'Parrilla‚Üíconducci√≥n; Horno‚Üíradiaci√≥n; Plancha‚Üíconvecci√≥n',
    'Todos por convecci√≥n',
    'Parrilla‚Üímicroondas; Horno‚Üíinducci√≥n; Plancha‚Üíradiaci√≥n'], correct:0},

  // LIP ‚Äì L√≠pidos y fritura (12)
  {tag:'LIP', q:'El calor espec√≠fico del agua vs aceites (~20¬∞C) es‚Ä¶', options:['Agua ‚âà 1; aceites ‚âà 0,47','Ambos ‚âà 1','Agua ‚âà 0,45; aceites ‚âà 1','Aceites ‚âà 0,1'], correct:0, explain:'El agua almacena m√°s calor por unidad de masa.'},
  {tag:'LIP', q:'Grasa s√≥lida vs l√≠quida: diferencia clave', options:['Presencia de cristales (‚â•10% en s√≥lida)','Solo por color','pH','Contenido de agua libre'], correct:0},
  {tag:'LIP', q:'Polimorfismo en grasas implica‚Ä¶', options:['Diferentes formas cristalinas (Œ±, Œ≤‚Äô, Œ≤) con distinta estabilidad','Variaci√≥n del pH','Cambios de aw exclusivamente','Oxidaci√≥n controlada'], correct:0},
  {tag:'LIP', q:'Templado de chocolate busca‚Ä¶', options:['Estabilizar forma Œ≤‚Äô/Œ≤ para brillo y textura','Eliminar toda grasa','Evitar cualquier cristal','Aumentar humedad'], correct:0},
  {tag:'LIP', q:'En fritura profunda, T recomendada general:', options:['170‚Äì190¬∞C','120‚Äì140¬∞C','>220¬∞C siempre','90‚Äì100¬∞C'], correct:0},
  {tag:'LIP', q:'Relaci√≥n alimento:aceite seg√∫n temperatura inicial:', options:['Refrigerado 1:5 ‚Ä¢ Congelado 1:10','Ambiente 1:1','Congelado 1:2','Siempre 1:20'], correct:0},
  {tag:'LIP', q:'Punto de humo disminuye cuando‚Ä¶', options:['Aumentan los AGL por hidr√≥lisis','Disminuye la luz ambiental','Se usa acero inoxidable','Se filtra el aceite'], correct:0},
  {tag:'LIP', q:'Orden de preferencia para fritar (punto de humo):', options:['Alto oleico > arroz > girasol > ma√≠z > soja','Soja > ma√≠z > girasol > arroz > alto oleico','Oliva extra virgen siempre primero','Todos iguales'], correct:0},
  {tag:'LIP', q:'Absorci√≥n lip√≠dica aumenta con‚Ä¶', options:['Mayor superficie/irregularidad y exceso de humedad','Piezas m√°s grandes y compactas','Aceite muy caliente (en rango) y tiempo corto','Baja carga del equipo'], correct:0},
  {tag:'LIP', q:'Acrole√≠na en frituras proviene de‚Ä¶', options:['Deshidrataci√≥n t√©rmica del glicerol','Oxidaci√≥n de hierro hemo','Fermentaci√≥n l√°ctica','Evaporaci√≥n de agua'], correct:0},
  {tag:'LIP', q:'Rango bibliogr√°fico de absorci√≥n de grasa en fritura:', options:['‚âà 4‚Äì45%','‚âà 0‚Äì3%','‚âà 60‚Äì90%','Siempre 25%'], correct:0},
  {tag:'LIP', q:'Mejor practica de almacenamiento del aceite usado:', options:['Filtrar caliente (~66¬∞C), envase de acero de cuello estrecho, tapado y fr√≠o','Pl√°stico abierto a temperatura ambiente','Mezclar con agua','Dejar part√≠culas para dar sabor'], correct:0},

  // HUE ‚Äì Huevo (9)
  {tag:'HUE', q:'Seguridad microbiol√≥gica (huevo/preparaciones):', options:['‚â•72¬∞C (y ‚â•80¬∞C en picadas/hamburguesas)','60¬∞C por segundos','Solo lavarlo','No requiere control t√©rmico'], correct:0},
  {tag:'HUE', q:'Complejo avidina‚Äëbiotina:', options:['Avidina se une a biotina; calor libera biotina','Biotina destruye la avidina','No afecta biodisponibilidad','Solo ocurre en yema'], correct:0},
  {tag:'HUE', q:'Orden general en coagulaci√≥n de prote√≠nas del huevo:', options:['Desnaturalizaci√≥n ‚Üí agregaci√≥n ‚Üí co√°gulo','Gelificaci√≥n ‚Üí desnaturalizaci√≥n','Caramelizaci√≥n ‚Üí coagulaci√≥n','Emulsi√≥n ‚Üí co√°gulo'], correct:0},
  {tag:'HUE', q:'Huevo ‚Äúpoached/pochet‚Äù y seguridad:', options:['Yema puede no alcanzar 72¬∞C ‚Üí no seguro','Siempre seguro por estar en agua','Depende solo del pH','El vinagre esteriliza'], correct:0},
  {tag:'HUE', q:'Clara vs yema: temperaturas de coagulaci√≥n:', options:['Clara antes; yema ~+5¬∞C m√°s','Ambas iguales','Yema antes que clara','No coagulan'], correct:0},
  {tag:'HUE', q:'Factores que estabilizan espuma de clara:', options:['√Åcido (m√°s estable), az√∫car tard√≠o, cocci√≥n','Aceite en bol','Clara muy fr√≠a','Exceso de agua'], correct:0},
  {tag:'HUE', q:'Az√∫car en batido de claras‚Ä¶', options:['Retarda formaci√≥n pero aumenta estabilidad','Acelera formaci√≥n y baja estabilidad','No tiene efecto','Desnaturaliza case√≠nas'], correct:0},
  {tag:'HUE', q:'En omelette/budines el huevo act√∫a como‚Ä¶', options:['Uni√≥n (y gel en flanes)','Colorante exclusivo','Fermento','Antioxidante √∫nicamente'], correct:0},
  {tag:'HUE', q:'Mayonesa casera:', options:['Emulsi√≥n inestable sanitariamente por huevo crudo','Sistema esterilizado','Gel proteico','Espuma seca'], correct:0},

  // CAR ‚Äì Carnes (10)
  {tag:'CAR', q:'CRA (capacidad de retenci√≥n de agua) depende de‚Ä¶', options:['pH y estructura proteica; m√≠nima cerca de pH ~5','Solo del contenido graso','Color inicial','Tipo de corte exclusivamente'], correct:0},
  {tag:'CAR', q:'Temperaturas gu√≠a para inocuidad (carne aviar):', options:['Pechuga > 90¬∞C, muslo > 95¬∞C','Siempre 60¬∞C','70¬∞C en todo caso','95¬∞C solo en pescado'], correct:0},
  {tag:'CAR', q:'Secuencia de cambios t√©rmicos en carne:', options:[
    '40‚Äì50¬∞C‚Üë dureza (miofibrilares); 60‚Äì65¬∞C col√°geno se contrae; 70‚Äì90¬∞C solubiliza‚Üíterneza',
    '20‚Äì30¬∞C gelatina; 35¬∞C Maillard; 40¬∞C carameliza',
    '60¬∞C todo se ablanda y no cambia luego',
    'No hay cambios definidos'], correct:0},
  {tag:'CAR', q:'Mioglobina y color tras cocci√≥n:', options:['Desnaturalizaci√≥n globina >80¬∞C + estado Fe2+/Fe3+ define pardeado','S√≥lo depende de grasa','Depende de lactosa','Invariable con temperatura'], correct:0},
  {tag:'CAR', q:'Jugosidad depende sobre todo de‚Ä¶', options:['CRA + grasa intramuscular (marmoleo) + contenido acuoso','S√≥lo del col√°geno','Solo del peso','pH del agua'], correct:0},
  {tag:'CAR', q:'Sous‚Äëvide en carnes:', options:['50‚Äì85¬∞C durante horas; mejora terneza y rendimiento sin Maillard','>120¬∞C al vac√≠o','No requiere cadena de fr√≠o','Siempre desarrolla corteza'], correct:0},
  {tag:'CAR', q:'Parrilla vs plancha vs hervido:', options:['Parrilla IR; plancha conducci√≥n; v√≠a h√∫meda sin Maillard','Todos producen Maillard igual','Hervido produce corteza parda intensa','Plancha no usa conducci√≥n'], correct:0},
  {tag:'CAR', q:'Zona de peligro microbiol√≥gica com√∫n:', options:['~5‚Äì60¬∞C','‚àí18‚Äì0¬∞C','>100¬∞C','<0¬∞C'], correct:0},
  {tag:'CAR', q:'Recalentamiento seguro sugerido:', options:['‚â•70¬∞C en el centro','60¬∞C','50¬∞C','No es necesario'], correct:0},
  {tag:'CAR', q:'Congelaci√≥n puede causar‚Ä¶', options:['Da√±o celular, p√©rdida de fluidos y oxidaci√≥n de grasas','Aumento de vitaminas siempre','Polimerizaci√≥n de az√∫cares','Eliminaci√≥n total de MO'], correct:0},

  // HC‚ÄëBPM ‚Äì HC simples (BPM) (7)
  {tag:'HC‚ÄëBPM', q:'Mayor poder edulcorante (a igual T):', options:['Fructosa > sacarosa > glucosa > lactosa','Sacarosa > fructosa > glucosa > lactosa','Glucosa > fructosa > sacarosa > lactosa','Lactosa > sacarosa > fructosa'], correct:0},
  {tag:'HC‚ÄëBPM', q:'El dulzor aumenta con‚Ä¶', options:['Temperaturas m√°s bajas (fr√≠o)','Temperaturas m√°s altas','M√°s viscosidad siempre','pH neutro'], correct:0},
  {tag:'HC‚ÄëBPM', q:'Soluciones sobresaturadas pueden‚Ä¶', options:['Cristalizar al enfriar (nucleaci√≥n‚Üícrecimiento)','No cristalizar jam√°s','Ser menos concentradas que saturadas','No dependen de agitaci√≥n'], correct:0},
  {tag:'HC‚ÄëBPM', q:'Higroscopicidad (mayor‚Üímenor):', options:['Fructosa > az√∫car invertido > sacarosa > glucosa > lactosa','Lactosa > fructosa > sacarosa > glucosa','Todas iguales','Depende solo del pH'], correct:0},
  {tag:'HC‚ÄëBPM', q:'Caramelizaci√≥n vs Maillard:', options:['Caramelizaci√≥n: az√∫car solo; Maillard: az√∫car reductor + AA/prote√≠nas','Ambas necesitan prote√≠nas','Ambas son enzim√°ticas','Ninguna genera color pardo'], correct:0},
  {tag:'HC‚ÄëBPM', q:'Maillard favorece con‚Ä¶', options:['Alta T, aw baja/moderada, pH neutro‚Äëalcalino, tiempo','pH √°cido fuerte y aw alta','Ausencia total de calor','Luz UV √∫nicamente'], correct:0},
  {tag:'HC‚ÄëBPM', q:'P√©rdida de lisina ocurre por‚Ä¶', options:['Reacci√≥n de Maillard','Caramelizaci√≥n','Convecci√≥n','Fermentaci√≥n alcoh√≥lica'], correct:0},

  // CEL‚ÄëLEG ‚Äì Cereales/leguminosas/pseudo (6)
  {tag:'CEL‚ÄëLEG', q:'En granulaci√≥n fina (salsa blanca/postres):', options:['Hidratar 1/3 del l√≠quido en fr√≠o; 2/3 luego; revolver para gelificar parejo','Hidratar con agua hirviendo','No hidratar','Agregar todo el az√∫car al inicio para evitar grumos'], correct:0},
  {tag:'CEL‚ÄëLEG', q:'Arroz de grano corto vs largo:', options:['Corto: + amilopectina (m√°s pegajoso); largo: + amilosa','Largo: + amilopectina','Iguales tecnol√≥gicamente','Depende solo del lavado'], correct:0},
  {tag:'CEL‚ÄëLEG', q:'Arroz parboil se caracteriza por‚Ä¶', options:['Almid√≥n pregelatinizado con vapor; no se pasa f√°cil','M√°s fibra soluble','Menos tiempo de cocci√≥n que todos','Ser integral siempre'], correct:0},
  {tag:'CEL‚ÄëLEG', q:'Leguminosas secas requieren‚Ä¶', options:['Remojo para reducir antinutrientes antes del calor','No remojo','Solo sal al inicio','Fermentaci√≥n alcoh√≥lica'], correct:0},
  {tag:'CEL‚ÄëLEG', q:'Pseudocereales (quinoa, amaranto, sarraceno):', options:['No son gram√≠neas; ricos en almid√≥n; sin gluten','Son gram√≠neas; con gluten','Solo l√≠pidos','No requieren lavado'], correct:0},
  {tag:'CEL‚ÄëLEG', q:'Quinoa: buena pr√°ctica previa a cocci√≥n:', options:['Lavar para quitar saponinas (amargor)','Remojar en aceite','No lavar jam√°s','A√±adir bicarbonato'], correct:0},

  // LEC ‚Äì Leche (7)
  {tag:'LEC', q:'Micelas de case√≠na se desestabilizan por‚Ä¶', options:['pH 4,6 (PI) o cuajo (quimosina)','M√°s luz','CO2','UHT'], correct:0},
  {tag:'LEC', q:'Prote√≠nas s√©ricas (Œ≤‚ÄëLG, Œ±‚ÄëLA) son‚Ä¶', options:['Termol√°biles; desnaturalizan con calor y sales deshidratantes','Termoestables como case√≠nas','Insolubles en todo pH','No afectan textura'], correct:0},
  {tag:'LEC', q:'Homogeneizaci√≥n de leche genera‚Ä¶', options:['Gl√≥bulos de grasa m√°s peque√±os ‚Üí emulsi√≥n m√°s estable y color m√°s blanco','Coagulaci√≥n proteica inmediata','Reducci√≥n de lactosa','Eliminaci√≥n de vitaminas'], correct:0},
  {tag:'LEC', q:'UHT t√≠pico y efecto:', options:['135‚Äì150¬∞C segundos + envase as√©ptico ‚Üí vida √∫til ambiente','63¬∞C 30 min ‚Üí cadena de fr√≠o','Hervor 100¬∞C 10 min ‚Üí esterilidad comercial','No cambia vitaminas hidrosolubles'], correct:0},
  {tag:'LEC', q:'Lactosa es‚Ä¶', options:['Disac√°rido reductor (Glc+Gal), dulzor bajo','Monosac√°rido no reductor','√Åcido org√°nico','Alcohol de az√∫car (poliol)'], correct:0},
  {tag:'LEC', q:'Leche descremada pierde sobre todo‚Ä¶', options:['Vitaminas liposolubles (A/D/E/K) con la grasa','Calcio por completo','Lactosa','Prote√≠nas s√©ricas'], correct:0},
  {tag:'LEC', q:'Sin√©resis en yogur aumenta con‚Ä¶', options:['Gel d√©bil/da√±o por agitaci√≥n','M√°s s√≥lidos l√°cteos totales','Gel bien formado','pH y T controlados'], correct:0},

  // GLU ‚Äì Gluten (7)
  {tag:'GLU', q:'Gluten se forma por‚Ä¶', options:['Harina de trigo + agua + amasado (gliadina+glutenina)','Solo por agregar sal','Cualquier harina sin prote√≠nas','Fr√≠o intenso'], correct:0},
  {tag:'GLU', q:'Gliadina vs glutenina:', options:['Gliadina: viscosidad/extensibilidad; Glutenina: elasticidad (puentes S‚ÄëS)','Ambas id√©nticas','Gliadina da color rojo','Glutenina es soluble en agua'], correct:0},
  {tag:'GLU', q:'pH y solubilidad de prote√≠nas del trigo:', options:['M√≠nima cerca de pH ~5 (PI) ‚Üí menos interacci√≥n con agua','M√°xima en pH 5','Independiente del pH','Solo depende de sodio'], correct:0},
  {tag:'GLU', q:'Sal en panificaci√≥n‚Ä¶', options:['Aporta firmeza al gluten; suele ‚â§2%','Inhibe toda fermentaci√≥n','Se evita siempre','Reduce volumen siempre'], correct:0},
  {tag:'GLU', q:'Az√∫car en masas dulces‚Ä¶', options:['Sustrato de levadura pero en exceso limita red de gluten','No afecta al gluten','Elimina agua ligada','Aumenta salinidad'], correct:0},
  {tag:'GLU', q:'L√≠pidos en masas‚Ä¶', options:['Peque√±as dosis mejoran volumen; exceso limita gluten','Siempre limitan gluten','No influyen','Endurecen el almid√≥n'], correct:0},
  {tag:'GLU', q:'Cocci√≥n del pan (orden):', options:['50‚Äì60¬∞C coagula gluten / inicia gelatinizaci√≥n; ~90¬∞C almid√≥n gelatinizado; >100¬∞C corteza (dextrinas+Maillard)','>100¬∞C primero; luego 50¬∞C','Carameliza antes de gelificar','No hay gelatinizaci√≥n'], correct:0},

  // F&H ‚Äì Frutas y hortalizas (9)
  {tag:'F&H', q:'Productos climat√©ricos vs no climat√©ricos:', options:['Climat√©ricos maduran post‚Äëcosecha (pico respiratorio)','Ninguno madura post‚Äëcosecha','Solo tropicales son climat√©ricos','Todos son no climat√©ricos'], correct:0},
  {tag:'F&H', q:'Da√±o por fr√≠o en tropicales/subtropicales evita con‚Ä¶', options:['Almacenamiento > ~10¬∞C','< 0¬∞C siempre','Cocci√≥n','Exceso de etileno'], correct:0},
  {tag:'F&H', q:'Pardeamiento enzim√°tico involucra‚Ä¶', options:['Polifenol oxidasa + O2 ‚Üí quinonas ‚Üí melaninas (pH 5‚Äì7; 30‚Äì35¬∞C √≥ptimos)','Solo calor seco','Az√∫car invertido','Case√≠nas'], correct:0},
  {tag:'F&H', q:'Clorofila en cocci√≥n puede pasar a‚Ä¶', options:['Feofitina (verde oliva/gris√°ceo) si no se aplica buena pr√°ctica','Antocianinas','Betala√≠nas','Carotenoides azules'], correct:0},
  {tag:'F&H', q:'Efecto del bicarbonato en clorofila:', options:['Forma clorofilina (verde intenso) pero afecta textura/sabor','No cambia el color','Siempre recomendado','Vuelve insoluble la clorofila'], correct:0},
  {tag:'F&H', q:'Flavonoides (antocianinas) cambian color con pH:', options:['√Åcido: rojo; neutro: p√∫rpura; alcalino: azul/verde','Independiente del pH','√Åcido: verde','Alcalino: rojo'], correct:0},
  {tag:'F&H', q:'Buena pr√°ctica: hoja verde en hervor:', options:['M√≠nima agua en ebullici√≥n; tapado; destapar 3‚Ä≤; volver a tapar; escurrir','Mucha agua fr√≠a y tapado todo el tiempo','Agua con bicarbonato siempre','Cocer sin hervir'], correct:0},
  {tag:'F&H', q:'Textura al cocinar vegetales:', options:['Pectinas insolubles ‚Üí solubles; hemicelulosas se ablandan; lignina no cambia','Lignina se disuelve','Solo por p√©rdida de agua','Celulosa se carameliza'], correct:0},
  {tag:'F&H', q:'Az√∫car en alm√≠bar (zapallo):', options:['Con Ca2+ endurece superficie; alta [az√∫car] dificulta solubilizar pectinas','Ablanda por completo','No afecta textura','Baja color'], correct:0},

  // ALM ‚Äì Almid√≥n APM (7)
  {tag:'ALM', q:'Gelatinizaci√≥n del almid√≥n comienza‚Ä¶', options:['>~60‚Äì70¬∞C seg√∫n variedad; hinchamiento y p√©rdida de orden','<10¬∞C','Sin calor','A 40¬∞C exactos'], correct:0},
  {tag:'ALM', q:'Orden de fen√≥menos (almid√≥n):', options:['Gelatinizaci√≥n ‚Üí gelificaci√≥n (al enfriar) ‚Üí retrogradaci√≥n','Retrogradaci√≥n ‚Üí gelatinizaci√≥n ‚Üí gelificaci√≥n','Gelificaci√≥n ‚Üí caramelizaci√≥n','Maillard ‚Üí gelificaci√≥n'], correct:0},
  {tag:'ALM', q:'Amilosa vs amilopectina:', options:['Amilosa lineal ~15‚Äì30%; primero en salir; gel firme; amilopectina 70‚Äì85% ramificada','Ambas lineales id√©nticas','Amilopectina lineal','Amilosa siempre 70‚Äì85%'], correct:0},
  {tag:'ALM', q:'Retrogradaci√≥n produce‚Ä¶', options:['Recristalizaci√≥n (geles m√°s firmes) y sin√©resis; mayor resistencia enzim√°tica','Gel m√°s blando siempre','M√°s dulzor','Disoluci√≥n total'], correct:0},
  {tag:'ALM', q:'Az√∫car y l√≠pidos sobre gelatinizaci√≥n:', options:['Az√∫car compite por agua (‚ÜëT/‚Üìhidrataci√≥n); l√≠pidos ‚Üërango de gelatinizaci√≥n','Az√∫car no influye','L√≠pidos la eliminan','Ambos la aceleran sin cambios'], correct:0},
  {tag:'ALM', q:'Pan envejece por‚Ä¶', options:['Retrogradaci√≥n de amilosa/almid√≥n (miga r√≠gida, corteza dura)','Oxidaci√≥n de clorofila','P√©rdida de lactosa','Desnaturalizaci√≥n de mioglobina'], correct:0},
  {tag:'ALM', q:'Almid√≥n resistente es‚Ä¶', options:['Fracci√≥n no digerida en ID; efecto prebi√≥tico','100% digerible','Solo dextrinas','Az√∫car reductor'], correct:0},

  // BPM ‚Äì Buenas Pr√°cticas (4)
  {tag:'BPM', q:'BPM buscan‚Ä¶', options:['Ambiente higi√©nico en toda la cadena ‚Üí inocuidad y calidad','Solo mejorar sabor','Eliminar etiquetado','Aumentar sodio'], correct:0},
  {tag:'BPM', q:'Riesgo se define como‚Ä¶', options:['Probabilidad de que ocurra un peligro (f√≠sico, qu√≠mico, biol√≥gico)','Da√±o siempre inevitable','Etiqueta frontal','Solo presencia de MO'], correct:0},
  {tag:'BPM', q:'Manipulador/utensilios/proceso implican‚Ä¶', options:['Tres frentes de control en BPM','Solo control del proceso','Solo del envase','No aplican en cocina'], correct:0},
  {tag:'BPM', q:'Guantes de nitrilo negros‚Ä¶', options:['Dificultan ver suciedad ‚Üí no recomendados','Son obligatorios','Esterilizan las manos','Reemplazan el lavado'], correct:0},

  // NORM ‚Äì Receta y Ficha t√©cnica (4)
  {tag:'NORM', q:'Receta estandarizada incluye‚Ä¶', options:['Encabezado, ingredientes (orden l√≥gico/porcentajes), procedimiento','Solo lista de compras','Diagrama de flujo y costos','HACCP completo'], correct:0},
  {tag:'NORM', q:'C√°lculo por % verdadero en receta:', options:['Base 100% = suma total de ingredientes','Base 100% = ingrediente mayor','Nunca se usa','Se basa en volumen √∫nicamente'], correct:0},
  {tag:'NORM', q:'Diagrama de flujo ‚Äì errores comunes:', options:['Omitir etapas, cruzar l√≠neas, poner cantidades/equipos','Mostrar solo fotos','No validar en terreno','Usar s√≠mbolos est√°ndar'], correct:0},
  {tag:'NORM', q:'Ficha t√©cnica agrega respecto a receta‚Ä¶', options:['Rol funcional de ingredientes y datos t√©cnicos','Solo formato bonito','Elimina procedimientos','Sustituye HACCP'], correct:0},
];

// ===== Utilidades =====
const $ = s => document.querySelector(s);
const grid = $('#grid');
const count = $('#count');
const answered = $('#answered');
const right = $('#right');
const progress = $('#progress');
const search = $('#search');
let STATE = {answers: {}, filter:'ALL', query:'', seed: Date.now()};

function shuffle(arr, rng=Math.random){
  for(let i=arr.length-1;i>0;i--){const j=Math.floor(rng()* (i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]}
  return arr;
}

function seededRandom(seed){
  let x = Math.sin(seed++)*10000; return ()=>{x=Math.sin(x)*10000; return x-Math.floor(x)};
}

function render(){
  const rng = seededRandom(STATE.seed);
  grid.innerHTML='';
  const filtered = BANK.filter(b=> STATE.filter==='ALL' ? true : b.tag===STATE.filter)
                      .filter(b=> !STATE.query || (b.q+ '\n' + b.options.join(' ')+ (b.explain||'')).toLowerCase().includes(STATE.query));
  count.textContent = filtered.length;
  let idx=0;
  filtered.forEach((item)=>{
    // Barajar opciones por tarjeta de forma determinista respecto a seed + enunciado
    const options = item.options.map((t,i)=>({t, i}));
    const localRng = seededRandom(STATE.seed + item.q.length + item.options.join('').length);
    shuffle(options, localRng);
    const correctIdx = options.findIndex(o=>o.i===item.correct);

    const card = document.createElement('div');
    card.className='card';
    const head = document.createElement('div'); head.className='qhead';
    head.innerHTML = `<span class="qno">${++idx}</span><div style="flex:1">${item.q}</div><span class="tag">${item.tag}</span>`;
    const opts = document.createElement('div'); opts.className='options';
    options.forEach((o,k)=>{
      const opt = document.createElement('div'); opt.className='opt';
      opt.innerHTML = `<div class="letter">${String.fromCharCode(65+k)}</div><div style="flex:1">${o.t}</div>`;
      opt.onclick = ()=>{
        if(opt.classList.contains('right') || opt.classList.contains('wrong')) return; // no multiple taps
        const wasRight = (k===correctIdx);
        opt.classList.add(wasRight? 'right':'wrong');
        // marcar el resto
        [...opts.children].forEach((el,m)=>{ if(m!==k){ el.style.opacity=0.8; }});
        STATE.answers[item.q] = wasRight;
        updateMeters();
        // explicaci√≥n
        if(item.explain){ const ex = document.createElement('div'); ex.className='explain'; ex.textContent = 'üí° ' + item.explain; opt.after(ex); }
      };
      opts.appendChild(opt);
    });
    card.appendChild(head); card.appendChild(opts);
    grid.appendChild(card);
  });
  updateMeters();
}

function updateMeters(){
  const keys = Object.keys(STATE.answers);
  const totalAnswered = keys.length;
  const totalRight = keys.filter(k=>STATE.answers[k]).length;
  answered.textContent = totalAnswered;
  right.textContent = totalRight;
  const totalShown = parseInt(count.textContent)||1;
  progress.textContent = Math.round((totalAnswered/totalShown)*100);
}

// Eventos UI
$('#shuffle').onclick = ()=>{ STATE.seed = Date.now(); STATE.answers={}; render(); };
$('#reset').onclick = ()=>{ STATE.answers={}; render(); };
$('#toTop').onclick = ()=> window.scrollTo({top:0,behavior:'smooth'});
$('#toBot').onclick = ()=> window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
search.oninput = (e)=>{ STATE.query = e.target.value.trim().toLowerCase(); render(); };

document.querySelectorAll('.tab').forEach(btn=>{
  btn.onclick = ()=>{
    document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    STATE.filter = btn.dataset.tab; STATE.answers={}; render();
  };
});

// Inicial
render();
</script>
</body>
</html>
